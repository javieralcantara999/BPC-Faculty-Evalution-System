<aside class="main-sidebar sidebar-green-primary elevation-4" style = "background-color: darkgreen;color:white;">
  <div class="dropdown">
    <a href="./indexx.php" class="brand-link">
      <!-- Palitan ang src at alt ng <img> tag base sa iyong logo -->
      <img src="./images/bpc.ico" alt="Logo" class="brand-image img-circle elevation-3" style="opacity: .8">
    </a>
  </div>
    <style> 
        .brand-link h3{
            color:white;
            right:0;
            font-size: 14px;
        }
        .brand-link.collapsed h3{
            color:white;
        }
    </style>
    
    <div class="sidebar" style="color:white;">
    <nav class="mt-2">
      <ul class="nav nav-pills nav-sidebar flex-column nav-flat" data-widget="treeview" role="menu" data-accordion="false">
        <li class="nav-item dropdown">
          <a href="./indexx.php" class="nav-link nav-home" id="sdbr">
            <i class="nav-icon fas fa-home"></i>
            <p>
              DASHBOARD
            </p>
          </a>
        </li>
        <li class="nav-item dropdown">
          <a href="./indexx.php?page=subject_list" class="nav-link nav-subject_list" id="sdbr">
            <i class="nav-icon fas fa-scroll"></i>
            <p>
              SUBJECTS
            </p>
          </a>
        </li> 
        <li class="nav-item dropdown">
          <a href="./indexx.php?page=class_list" class="nav-link nav-class_list" id="sdbr">
            <i class="nav-icon fas fa-list-ul"></i>
            <p>
              SECTIONS
            </p>
          </a>
        </li> 
        <li class="nav-item dropdown">
          <a href="./indexx.php?page=academic_list" class="nav-link nav-academic_list" id="sdbr">
            <i class="nav-icon fas fa-calendar-alt"></i>
            <p>
              SCHOOL YEAR
            </p>
          </a>
        </li> 
        <li class="nav-item has-treeview">
          <a href="#" class="nav-link"id="sdbr">
            <i class="nav-icon fas fa-tasks"></i>
            <p>
              EVALUATION (STUDENTS) &nbsp;
              <i class="fas fa-caret-down"></i>
            </p>
          </a>
            <ul class="nav nav-treeview">
                <li class="nav-item">
                    <a href="./indexx.php?page=questionnaire" class="nav-link nav-questionnaire"id="sdbr">
                        <i class="fas fa-caret-right"></i>
                        <i class="nav-icon fas fa-envelope-open-text"></i>
                        <p> MANAGE QUESTION FORM</p>
                    </a>
                </li>
                <li class="nav-item">
                <a href="./indexx.php?page=criteria_list" class="nav-link nav-criteria_list"id="sdbr">
                        <i class="fas fa-caret-right"></i>
                    <i class="nav-icon fas fa-clipboard-list"></i>
                    <p>EVALUATION CRITERIA</p>
                </a>
                </li>
                <li class="nav-item">
                <a href="./indexx.php?page=question_list" class="nav-link nav-question_list"id="sdbr">
                        <i class="fas fa-caret-right"></i>
                    <i class="nav-icon fas fa-question-circle"></i>
                    <p>QUESTIONS</p>
                </a>
                </li>
                <li class="nav-item">
                <a href="./indexx.php?page=report" class="nav-link nav-report"id="sdbr">
                        <i class="fas fa-caret-right"></i>
                    <i class="nav-icon fas fa-chart-bar"></i>
                    <p>EVALUATION RESULTS</p>
                </a>
                </li>
            </ul>
            </li>
        <li class="nav-item has-treeview">
          <a href="#" class="nav-link"id="sdbr">
            <i class="nav-icon fas fa-tasks"></i>
            <p>
              EVALUATION (SUPERIORS) &nbsp;
              <i class="fas fa-caret-down"></i>
            </p>
          </a>
          <ul class="nav nav-treeview">
            <li class="nav-item">
                <a href="./indexx.php?page=questionnaire_superior" class="nav-link nav-questionnaire_superior"id="sdbr">
                        <i class="fas fa-caret-right"></i>
                    <i class="nav-icon fas fa-envelope-open-text"></i>
                    <p> MANAGE QUESTION FORM</p>
                </a>
            </li>
            <li class="nav-item">
              <a href="./indexx.php?page=criteria_list_superior" class="nav-link nav-criteria_list_superior"id="sdbr">
                        <i class="fas fa-caret-right"></i>
                <i class="nav-icon fas fa-clipboard-list"></i>
                <p> EVALUATION CRITERIA</p>
              </a>
            </li>
            <li class="nav-item">
              <a href="./indexx.php?page=question_list_superior" class="nav-link nav-question_list_superior"id="sdbr">
                        <i class="fas fa-caret-right"></i>
                <i class="nav-icon fas fa-question-circle"></i>
                <p>QUESTIONS</p>
              </a>
            </li>
            <li class="nav-item">
              <a href="./indexx.php?page=report_superior" class="nav-link nav-report_superior"id="sdbr">
                        <i class="fas fa-caret-right"></i>
                <i class="nav-icon fas fa-chart-bar"></i>
                <p>EVALUATION RESULTS</p>
              </a>
            </li>
          </ul>
        </li>
        <li class="nav-item dropdown">
          <a href="./indexx.php?page=superior_list" class="nav-link nav-superior_list" id="sdbr">
            <i class="nav-icon fas fa-user-tie"></i>
            <p>
              SUPERIORS
            </p>
          </a>
        </li> 
        <li class="nav-item dropdown">
          <a href="./indexx.php?page=faculty_list" class="nav-link nav-faculty_list" id="sdbr">
            <i class="nav-icon fas fa-user-friends"></i>
            <p>
              FACULTY MEMBERS
            </p>
          </a>
        </li> 
        <li class="nav-item dropdown">
          <a href="./indexx.php?page=student_list" class="nav-link nav-student_list" id="sdbr">
            <i class="nav-icon fas fa-users"></i>
            <p>
              STUDENTS
            </p>
          </a>
        </li> 
        <li class="nav-item dropdown">
          <a href="./indexx.php?page=sentiment_terms" class="nav-link nav-sentiment_terms" id="sdbr">
            <i class="nav-icon fas fa-comment"></i>
            <p>
              TERMINOLOGIES
            </p>
          </a>
        </li>
        <li class="nav-item dropdown">
          <a href="./indexx.php?page=faculty_feedbacks" class="nav-link nav-faculty_feedbacks" id="sdbr">
            <i class="nav-icon fas fa-comments"></i>
            <p>
              FEEDBACKS (STUDENTS)
            </p>
          </a>
        </li>
        <li class="nav-item dropdown">
          <a href="./indexx.php?page=faculty_feedbacks_superior" class="nav-link nav-faculty_feedbacks_superior" id="sdbr">
            <i class="nav-icon fas fa-comment-dots"></i>
            <p>
              FEEDBACKS (SUPERIORS)
            </p>
          </a>
        </li>
        <li class="nav-item dropdown">
          <a href="./indexx.php?page=user_list" class="nav-link nav-user_list" id="sdbr">
            <i class="nav-icon fas fa-chalkboard-teacher"></i>
            <p>
              ADMIN USERS
            </p>
          </a>
        </li>
        <?php
    // Database connection
            include 'db_connect.php';

            // Query to get total pending account requests count
            $sql = "SELECT COUNT(*) AS total_requests FROM account_request";
            $result = $conn->query($sql);

            $total_requests = 0; // Initialize total requests count

            if ($result) {
                // Check if query executed successfully
                $row = $result->fetch_assoc();
                if ($row && isset($row["total_requests"])) {
                    $total_requests = $row["total_requests"];
                }
            }

            // Close database connection
            $conn->close();
        ?>

        <style>
            .brand-link h3 {
                color: white;
                right: 0;
                font-size: 14px;
            }

            .brand-link.collapsed h3 {
                color: white;
            }
            /* Icon para sa bukas na menu */
            .nav-link .fas.fa-caret-down {
                display: inline-block; /* Ipakita ang icon ng down arrow */
            }

            /* Icon para sa isara na menu */
            .nav-link .fas.fa-caret-right {
                display: none; /* Itago ang icon ng right arrow */
            }

            /* Ipakita ang right arrow kapag bukas ang treeview */
            .nav-treeview.active {
                display: block;
            }

            /* Kapag active ang menu, ipakita ang left arrow */
            .nav-link.active .fas.fa-caret-down {
                display: none; /* Itago ang down arrow */
            }
            .nav-link.active .fas.fa-caret-right {
                display: inline-block; /* Ipakita ang right arrow */
            }
        </style>

        <li class="nav-item dropdown">
            <a href="./indexx.php?page=pending_accounts" class="nav-link nav-pending_accounts" id="sdbr">
                <i class="nav-icon fas fa-clock"></i>
                <p>
                    PENDING ACCOUNTS &nbsp;
                    <span class="badge badge-danger" style="font-size:12px"><?php echo $total_requests; ?></span>
                </p>
            </a>
        </li>
      </ul>
    </nav>
  </div>
  </aside>
<script>
   $(document).ready(function () {
    var page = '<?php echo isset($_GET['page']) ? $_GET['page'] : 'home' ?>';
    var s = '<?php echo isset($_GET['s']) ? $_GET['s'] : '' ?>';
    
    
    $('.nav-link.nav-' + page).addClass('active');
    if (s != '')
        page = page + '_' + s;

    // Idagdag ang active class sa current nav-link
    if ($('.nav-link.nav-' + page).length > 0) {
        $('.nav-link.nav-' + page).addClass('active')
        
        $('.nav-link.nav-' + page).addClass('active')
        // Hanapin ang parent na may treeview at i-expand ito
        var parentTreeview = $('.nav-link.nav-' + page).closest('.has-treeview');
    if (parentTreeview.length > 0) {
        parentTreeview.addClass('menu-open'); // Open the parent treeview
        parentTreeview.children('.nav-treeview').addClass('active'); // Activate the treeview

        // Change caret icon based on the state of the treeview
        parentTreeview.children('.nav-link').find('.fas.fa-caret-down').removeClass('fa-caret-down').addClass('fa-caret-left');
    }
    }

    // Palitan ang caret icon kapag binuksan ang treeview
    $('.nav-item.has-treeview > .nav-link').on('click', function (e) {
        e.preventDefault();
        var treeView = $(this).siblings('.nav-treeview');

        if (treeView.is(':visible')) {
            // Isara ang treeview
            treeView.slideUp();
            $(this).find('.fas.fa-caret-left').removeClass('fa-caret-left').addClass('fa-caret-down');
        } else {
            // Buksan ang treeview
            treeView.slideDown();
            $(this).find('.fas.fa-caret-down').removeClass('fa-caret-down').addClass('fa-caret-left');
        }
    });

    // I-update ang text sa sidebar depende sa kondisyon ng sidebar
    updateSidebarText();

    // Event listener para sa pag-expand o pag-minimize ng sidebar
    $('[data-widget="treeview"]').on('expanded.treeview collapsed.treeview', function () {
        updateSidebarText();
    });

    // Function para i-update ang laman ng #sidebar-title
    function updateSidebarText() {
        if ($('.main-sidebar').hasClass('sidebar-collapse')) {
            // Minimized
            $('#sidebar-title img').show();
            $('#sidebar-title span').hide();
        } else {
            // Expanded
            $('#sidebar-title img').hide();
            $('#sidebar-title span').show();
        }
    }
    
});
</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <style>
    /* Default icon style */
.nav-treeview {
    display: none; /* Itago ang sub-menu by default */
}

/* I-expand ang icon kapag binuksan ang menu */
.nav-treeview.active {
    display: block;
}

/* Icon para sa bukas na menu */
.nav-link .fas.fa-angle-down {
    display: inline-block; /* Ipakita ang icon ng down arrow */
}

/* Icon para sa isara na menu */
.nav-link .fas.fa-angle-left {
    display: none; /* Itago ang icon ng left arrow */
}
    .status-dot {
    width: 10px;
    height: 10px;
    background-color: green;
    border-radius: 50%;
    margin-left: 5px; /* Adjust as needed */
}
    #sdbr{
        background:green;
        color:whitesmoke;
        padding:10px;
        font-size:12px;
        margin:2px 5px 2px 5px;
        border-radius: 5px;
        font-weight: bold;
        text-align: left;
        padding-top:15px;
        padding-bottom:15px;
    }
    #sdbr.active,
    #sdbr:hover {
        background: lightgreen;
        color: black;
    }
    #sdbr:hover{
        background:lightgreen;
        color:black;
    }
    
  </style>
  <script>
    $(document).ready(function () {
        var page = '<?php echo isset($_GET['page']) ? $_GET['page'] : 'home' ?>';
        var s = '<?php echo isset($_GET['s']) ? $_GET['s'] : '' ?>';

        if (s != '')
            page = page + '_' + s;

        if ($('.nav-link.nav-' + page).length > 0) {
            $('.nav-link.nav-' + page).addClass('active')

            if ($('.nav-link.nav-' + page).hasClass('tree-item') == true) {
                $('.nav-link.nav-' + page).closest('.nav-treeview').siblings('a').addClass('active')
                $('.nav-link.nav-' + page).closest('.nav-treeview').parent().addClass('menu-open')
            }

            if ($('.nav-link.nav-' + page).hasClass('nav-is-tree') == true) {
                $('.nav-link.nav-' + page).parent().addClass('menu-open')
            }
        }

        // Palitan ang text sa sidebar depende sa kondisyon ng sidebar
        updateSidebarText();

        // Event listener para sa pag-expand o pag-minimize ng sidebar
        $('[data-widget="treeview"]').on('expanded.treeview collapsed.treeview', function () {
            updateSidebarText();
        });

        // Function para i-update ang laman ng #sidebar-title
        function updateSidebarText() {
            if ($('.main-sidebar').hasClass('sidebar-collapse')) {
                // Minimized
                $('#sidebar-title img').show();
                $('#sidebar-title span').hide();
            } else {
                // Expanded
                $('#sidebar-title img').hide();
                $('#sidebar-title span').show();
            }
        }
    });
</script>

<style>
    #sidebar-title img {
  display: inline;
}

#sidebar-title span {
  display: none;
}

#sidebar-title.collapsed img {
  display: none;
}

#sidebar-title.collapsed span {
  display: inline;
}
</style>
